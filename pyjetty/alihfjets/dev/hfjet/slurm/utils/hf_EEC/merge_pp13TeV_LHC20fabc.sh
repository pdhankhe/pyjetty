#! /bin/bash
#
# Script to merge output ROOT files

JOB_ID=1355790
OUTPUT_DIR=/rstorage/alice/AnalysisResults/preeti/EEC/$JOB_ID

# Merge separate subsets, since otherwise it is too large for hadd
RUNLIST_LHC20fa="285009 285011 285012 285013 285014 285015 285064 285065 285066 285106 285108 285125 285127 285165 285200 285202 285203 285222 285224 285327 285328 285347 285364 285365 285396 285978 285979 285980 286014 286025 286027 286028 286030 286064 286124 286127 286129 286130 286159 286198 286199 286201 286202 286203 286229 286230 286231 286254 286257 286258 286261 286263 286282 286284 286287 286288 286289 286308 286309 286310 286311 286312 286313 286314 286336 286337 286340 286341 286345 286348 286349 286350 286380 286426 286427 286428 286454 286455 286482 286502 286508 286509 286511 286566 286567 286568 286569 286591 286592 286633 286653 286661 286695 286731 286799 286801 286805 286809 286846 286850 286852 286874 286876 286877 286907 286910 286911 286930 286931 286932 286933 286936 286937 287000 287021 287063 287064 287066 287071 287072 287077 287137 287155 287185 287201 287202 287203 287204 287208 287209 287248 287249 287250 287251 287254 287283 287323 287324 287325 287343 287344 287346 287347 287349 287353 287355 287356 287360 287380 287381 287385 287387 287388 287389 287413 287451 287480 287481 287484 287486 287513 287516 287517 287518 287521 287524 287575 287578 287654 287656 287657 287658 287783 287784 287876 287877 287884 287885 287911 287912 287913 287915 287923 287941 287975 287977 288619 288640 288642 288644 288650 288687 288689 288690 288743 288748 288750 288804 288806 288861 288862 288863 288864 288868 288897 288902 288903 288908 288909 288943 289165 289166 289167 289169 289172 289175 289176 289177 289198 289199 289200 289201 289240 289241 289242 289243 289247 289249 289253 289254 289275 289276 289277 289278 289280 289281 289300 289303 289306 289308 289309 289353 289354 289355 289356 289365 289366 289367 289368 289369 289370 289373 289374 289426 289444 289462 289463 289465 289466 289468 289493 289494 289521 289547 289574 289576 289577 289582 289625 289632 289634 289657 289658 289659 289660 289664 289666 289721 289723 289724 289729 289731 289732 289757 289775 289808 289811 289814 289815 289816 289817 289818 289830 289849 289852 289854 289855 289856 289857 289879 289880 289884 289928 289931 289935 289940 289941 289943 289965 289966 289971 290323 290327 290350 290374 290375 290376 290399 290401 290404 290411 290412 290423 290425 290426 290427 290456 290458 290459 290467 290469 290499 290500 290501 290538 290539 290540 290544 290549 290550 290553 290588 290590 290612 290613 290614 290615 290627 290632 290645 290660 290665 290687 290689 290766 290787 290790 290841 290843 290846 290848 290853 290860 290862 290886 290887 290888 290894 290895 290932 290935 290941 290943 290944 290948 290974 290975 290976 290979 290980 291002 291003 291004 291005 291006 291035 291037 291041 291065 291066 291069 291093 291100 291101 291110 291111 291116 291143 291188 291209 291240 291257 291262 291263 291265 291266 291282 291284 291285 291286 291360 291361 291362 291363 291373 291375 291377 291397 291399 291400 291402 291416 291417 291420 291424 291447 291451 291453 291456 291457 291481 291482 291484 291485 291590 291614 291615 291618 291622 291624 291626 291657 291661 291665 291690 291697 291698 291706 291729 291755 291756 291760 291762 291766 291768 291769 291795 291796 291803 291942 291943 291944 291945 291946 291948 291953 291976 291977 291982 292012 292040 292060 292061 292062 292067 292075 292077 292080 292081 292106 292107 292108 292109 292114 292115 292140 292160 292161 292162 292163 292164 292166 292167 292168 292192 292218 292240 292241 292242 292265 292273 292298 292397 292398 292405 292406 292428 292429 292430 292432 292434 292456 292457 292460 292461 292495 292496 292497 292500 292521 292523 292524 292526 292553 292554 292557 292559 292560 292563 292584 292586 292693 292695 292696 292698 292701 292704 292737 292739 292744 292747 292748 292750 292752 292803 292804 292809 292810 292811 292831 292832 292834 292836 292839 293357 293359 293368 293386 293392 293413 293424 293474 293475 293494 293496 293570 293571 293573 293578 293579 293582 293583 293587 293588 293691 293692 293695 293696 293698 293740 293741 293770 293773 293774 293776 293802 293805 293806 293807 293809 293829 293830 293831 293856 293886 293891 293893 293896 293898 294009 294010 294011 294012 294013 294131 294152 294154 294155 294156 294199 294200 294201 294205 294208 294210 294212 294241 294242 294305 294307 294308 294310 294524 294525 294526 294527 294529 294530 294531 294553 294556 294558 294562 294563 294586 294587 294590 294591 294593 294632 294633 294636 294653 294703 294710 294715 294718 294722 294741 294742 294744 294745 294746 294747 294749 294769 294772 294774 294775 294805 294809 294813 294815 294816 294817 294818 294852 294875 294880 294883 294884 294916 294925"
for RUN in $RUNLIST_LHC20fa
do
   FILE_DIR=$OUTPUT_DIR/LHC20fa/$RUN
   FILES=$( find "$FILE_DIR" -name "*.root" )
   hadd -f -j 20 $FILE_DIR/AnalysisResultsIntermediate.root $FILES
done

RUNLIST_LHC20fb="270822 270824 270827 270828 270830 270854 270855 270856 270861 270865 271870 271871 271873 271874 271880 271886 272018 272020 272036 272038 272039 272040 272042 272075 272076 272100 272101 272123 272151 272152 272153 272154 272155 272156 272194 272335 272340 272359 272360 272388 272389 272394 272395 272399 272400 272411 272413 272414 272417 272461 272462 272463 272466 272468 272469 272521 272574 272575 272577 272585 272607 272608 272610 272620 272690 272691 272712 272747 272749 272760 272762 272763 272764 272782 272783 272784 272828 272829 272833 272834 272836 272870 272871 272873 272880 272903 272905 272932 272933 272934 272935 272939 272947 272949 272976 272983 272985 273009 273010 273077 273099 273100 273101 273103 273591 273592 273593 273653 273654 273824 273825 273885 273886 273887 273889 273918 273942 273943 273946 273985 273986 274058 274063 274092 274094 274125 274147 274148 274174 274212 274232 274258 274259 274263 274264 274266 274268 274269 274270 274271 274276 274278 274280 274281 274283 274329 274352 274355 274357 274360 274363 274364 274385 274386 274387 274388 274389 274390 274442 274593 274594 274595 274596 274601 274653 274657 274667 274669 274671 274690 274708 274736 274801 274802 274803 274806 274815 274821 274822 274877 274878 274882 274883 274884 274886 274889 274978 274979 275067 275068 275073 275075 275076 275149 275150 275151 275173 275174 275177 275180 275184 275188 275239 275245 275246 275247 275283 275314 275322 275324 275326 275328 275332 275333 275360 275361 275369 275372 275401 275404 275406 275443 275448 275452 275453 275456 275457 275459 275467 275471 275472 275515 275558 275559 275612 275617 275621 275622 275623 275624 275647 275648 275650 275661 275664 275847 276097 276098 276099 276102 276104 276105 276108 276135 276140 276141 276145 276166 276169 276170 276177 276178 276205 276230 276257 276259 276290 276292 276294 276297 276302 276348 276351 276435 276437 276438 276439 276462 276506 276507 276508 276551 276552 276553 276556 276557 276608 276644 276669 276670 276671 276672 276674 276675 276762 276916 276917 276920 276967 276969 276970 276971 276972 277015 277016 277017 277037 277073 277076 277079 277082 277087 277091 277117 277121 277155 277180 277181 277182 277183 277184 277188 277189 277193 277194 277196 277197 277256 277257 277262 277293 277310 277312 277314 277360 277383 277384 277385 277386 277389 277416 277417 277418 277470 277472 277473 277476 277477 277478 277479 277530 277531 277534 277536 277537 277574 277575 277576 277577 277721 277722 277723 277725 277745 277746 277747 277749 277794 277795 277799 277800 277801 277802 277805 277834 277836 277841 277842 277845 277847 277848 277870 277876 277897 277898 277899 277900 277903 277904 277907 277930 277952 277987 277988 277989 277991 277996 278121 278122 278123 278126 278127 278130 278158 278164 278165 278166 278167 278189 278191 278215 278216 278914 278915 278936 278939 278941 278959 278960 278963 278964 278999 279000 279005 279007 279008 279035 279036 279041 279043 279044 279068 279069 279073 279074 279075 279106 279107 279117 279118 279122 279123 279130 279155 279157 279199 279201 279207 279208 279232 279234 279235 279238 279242 279264 279265 279267 279268 279270 279273 279274 279309 279310 279312 279342 279344 279348 279349 279354 279355 279391 279410 279435 279439 279441 279483 279487 279488 279491 279550 279559 279630 279632 279641 279642 279676 279677 279679 279682 279683 279684 279687 279688 279689 279715 279718 279719 279747 279749 279773 279826 279827 279830 279853 279854 279855 279879 280051 280052 280066 280107 280108 280111 280114 280118 280126 280131 280134 280135 280140 280282 280284 280285 280286 280290 280310 280312 280348 280349 280350 280351 280352 280374 280375 280403 280405 280406 280412 280415 280419 280443 280445 280446 280447 280448 280490 280499 280518 280519 280546 280547 280550 280551 280574 280581 280583 280613 280634 280636 280637 280639 280645 280647 280648 280650 280671 280673 280676 280679 280681 280705 280706 280729 280753 280754 280755 280756 280757 280761 280762 280763 280764 280765 280766 280767 280768 280786 280787 280792 280793 280842 280844 280847 280848 280849 280854 280856 280880 280897 280936 280940 280943 280947 280990 280994 280996 280997 280998 280999 281032 281033 281035 281036 281060 281061 281062 281080 281081 281179 281180 281181 281189 281190 281191 281212 281213 281240 281241 281242 281243 281244 281271 281273 281275 281277 281301 281321 281415 281441 281443 281444 281446 281449 281450 281475 281477 281509 281511 281557 281562 281563 281568 281569 281574 281580 281581 281583 281592 281633 281705 281706 281707 281709 281713 281741 281750 281751 281753 281754 281755 281756 281892 281893 281894 281895 281915 281916 281918 281920 281928 281931 281932 281939 281940 281953 281956 281961 282528 282544 282545 282546 282573 282575 282579 282580 282606 282607 282608 282609 282618 282620 282622 282629 282651 282666 282667 282670 282671 282673 282676 282677 282700 282702 282703 282704"
for RUN in $RUNLIST_LHC20fb
do
   FILE_DIR=$OUTPUT_DIR/LHC20fb/$RUN
   FILES=$( find "$FILE_DIR" -name "*.root" )
   hadd -f -j 20 $FILE_DIR/AnalysisResultsIntermediate.root $FILES
done

RUNLIST_LHC20fc="252235 252248 252271 252310 252317 252319 252322 252325 252326 252330 252332 252336 252368 252370 252371 252374 252375 252858 252867 253437 253478 253481 253482 253488 253517 253529 253530 253563 253589 253591 254128 254147 254149 254174 254175 254178 254193 254199 254204 254205 254293 254302 254303 254304 254330 254331 254332 254604 254606 254621 254629 254630 254632 254640 254644 254646 254648 254649 254651 254652 254653 254654 254983 254984 255079 255082 255085 255086 255091 255111 255154 255159 255162 255167 255171 255173 255174 255176 255177 255180 255181 255182 255240 255242 255247 255248 255249 255251 255252 255253 255255 255256 255275 255276 255280 255283 255350 255351 255352 255398 255402 255407 255415 255418 255419 255420 255421 255440 255442 255447 255463 255465 255466 255467 255469 256219 256223 256225 256227 256228 256231 256281 256282 256283 256284 256287 256289 256290 256292 256295 256297 256299 256302 256307 256309 256311 256356 256361 256362 256363 256364 256365 256366 256368 256371 256372 256373 256415 256417 256418 256941 256942 256944 257011 257012 257071 257077 257080 257082 257084 257086 257092 257095 257100 257136 257137 257138 257139 257141 257144 257204 257206 257209 257224 257260 257318 257320 257322 257330 257358 257364 257433 257457 257468 257474 257487 257488 257490 257491 257492 257530 257531 257537 257539 257540 257541 257560 257561 257562 257566 257587 257588 257590 257592 257594 257595 257601 257604 257605 257606 257630 257632 257635 257636 257642 257644 257682 257684 257685 257687 257688 257689 257691 257692 257694 257697 257724 257725 257727 257733 257734 257735 257737 257754 257757 257765 257773 257797 257798 257799 257800 257803 257804 257850 257851 257853 257855 257901 257912 257932 257936 257937 257939 257957 257960 257963 257979 257986 257989 257992 258003 258008 258012 258014 258017 258019 258039 258041 258042 258045 258049 258053 258059 258060 258062 258063 258107 258108 258109 258113 258114 258117 258178 258197 258198 258202 258203 258204 258256 258257 258258 258270 258271 258273 258274 258278 258280 258299 258301 258302 258303 258306 258307 258332 258336 258359 258387 258388 258391 258393 258426 258452 258454 258456 258477 258498 258499 258537 258962 258964 259086 259088 259090 259091 259096 259099 259117 259118 259162 259164 259204 259257 259261 259263 259264 259269 259270 259271 259272 259273 259274 259302 259303 259305 259307 259334 259336 259339 259340 259341 259342 259378 259381 259382 259388 259389 259394 259395 259396 259473 259477 259747 259748 259750 259751 259752 259756 259781 259788 259789 259822 259841 259842 259860 259866 259867 259868 259888 262424 262425 262426 262428 262430 262450 262451 262487 262489 262490 262492 262528 262532 262533 262537 262563 262567 262568 262569 262570 262571 262572 262574 262578 262583 262593 262594 262624 262628 262632 262635 262705 262706 262708 262713 262717 262719 262723 262725 262727 262760 262768 262776 262777 262778 262841 262842 262844 262847 262849 262853 262855 262858 263331 263332 263487 263490 263496 263497 263529 263647 263652 263654 263657 263662 263663 263682 263690 263691 263737 263738 263739 263741 263743 263744 263784 263785 263786 263787 263790 263792 263793 263803 263810 263863 263866 263905 263916 263917 263920 263923 263977 263978 263979 263981 263984 263985 264033 264035 264076 264078 264082 264085 264086 264109 264110 264129 264137 264138 264139 264164 264168 264188 264190 264194 264197 264198 264232 264233 264235 264238 264259 264260 264261 264262 264264 264265 264266 264267 264273 264277 264279 264281 264305 264306 264312 264336 264341 264345 264346 264347"

for RUN in $RUNLIST_LHC20fc
do
   FILE_DIR=$OUTPUT_DIR/LHC20fc/$RUN
   FILES=$( find "$FILE_DIR" -name "*.root" )
   hadd -f -j 20 $FILE_DIR/AnalysisResultsIntermediate.root $FILES
done



FILES=$( find $OUTPUT_DIR/LHC*/ -name "AnalysisResultsIntermediate.root" )
hadd -f $OUTPUT_DIR/AnalysisResultsFinal.root $FILES
